# Cilium Overrides - Apply ON TOP of base values
# Usage: helm upgrade cilium cilium/cilium --version 1.18.6 -f cilium-values-base.yaml -f cilium-overrides.yaml
#
# These override the base values to enable Gateway API functionality

# Gateway API - core feature
gatewayAPI:
  enabled: true
  hostNetwork:
    enabled: true
    nodes:
      matchLabels:
        role: gateway
  secretsNamespace:
    create: true
    name: cilium-secrets
    sync: true

# Required for Gateway API
envoyConfig:
  enabled: true

# Required prerequisite for Gateway API in Cilium 1.18
nodePort:
  enabled: true

# Fix: Envoy needs NET_BIND_SERVICE to bind ports 80/443
# TODO: This needs to be verified/fixed in morning session
envoy:
  securityContext:
    capabilities:
      keepCapNetBindService: true
      envoy:
      - NET_ADMIN
      - SYS_ADMIN
      - NET_BIND_SERVICE
